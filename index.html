<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>PAEI Тест</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background:#f5f6fa;
    margin:0;
    padding:20px;
  }
  .block {
    background:white;
    padding:20px;
    border-radius:12px;
    box-shadow:0 2px 10px rgba(0,0,0,0.1);
    max-width:600px;
    margin:20px auto;
  }
  .question { margin-bottom:20px; }
  label { font-weight:bold; display:block; margin-bottom:4px; }
  .options label { font-weight:normal; margin-right:10px; }
  .sum { font-weight:bold; margin-top:10px; color:#333; text-align:right; }
  .hidden { display:none; }
  button {
    background:#007bff;
    color:white;
    border:none;
    border-radius:8px;
    padding:10px 20px;
    cursor:pointer;
    font-size:16px;
    margin-top:10px;
  }
  button:disabled {
    background:#ccc;
    cursor:not-allowed;
  }
  .results {
    max-width:600px;
    background:white;
    margin:30px auto;
    padding:25px;
    border-radius:12px;
    text-align:center;
    box-shadow:0 2px 10px rgba(0,0,0,0.1);
  }
</style>
</head>
<body>

<div id="container"></div>

<div id="results" class="results hidden">
  <h2>Результати</h2>
  <p><b>A (P)</b>: <span id="scoreA">0</span></p>
  <p><b>B (A)</b>: <span id="scoreB">0</span></p>
  <p><b>C (E)</b>: <span id="scoreC">0</span></p>
  <p><b>D (I)</b>: <span id="scoreD">0</span></p>
  <h3 id="dominant"></h3>
</div>

<script>
const data = [
  ["А. Залучений", "Б. Сумнівний", "В. Яскравий", "Г. Чуйний"],
  ["А. Прямолінійний", "Б. Аналізуючий", "В. Харизматичний", "Г. Чуттєвий"],
  ["А. Роблячий", "Б. Споглядаючий", "В. Провокуючий", "Г. Співчувальний"],
  ["А. Що усвідомлює", "Б. Оцінюючий", "В. Що йде на ризик", "Г. Доброзичливий"],
  ["А. Результативний", "Б. Логічний", "В. Задає питання", "Г. Інтуїтивний"],
  ["А. Завзятий", "Б. Консервативний", "В. Радикальний", "Г. Товариський"],
  ["А. Активний", "Б. Споглядаючий", "В. Абстрактний", "Г. Взаємодіючий"],
  ["А. Прагматичний", "Б. Розмірковуючий", "В. Дивиться в майбутнє", "Г. Теплий"],
  ["А. Переможець", "Б. Точний", "В. Концептуальний", "Г. Що прагне консенсусу"],
  ["А. Раціональний", "Б. Стриманий", "В. Генеруючий ідеї", "Г. Обізнаний"],
  ["А. Діловий", "Б. Акуратний", "В. Яскравий", "Г. Приємний"],
  ["А. Реалістичний", "Б. Обережний", "В. Мрійник", "Г. Що об’єднує"]
];

const container = document.getElementById('container');
let currentBlock = 0;

// === Генеруємо всі блоки ===
data.forEach((blockData, index) => {
  const div = document.createElement('div');
  div.classList.add('block');
  if (index !== 0) div.classList.add('hidden');
  div.id = `block${index}`;

  blockData.forEach((text, i) => {
    const qLetter = ['A','B','C','D'][i];
    const qDiv = document.createElement('div');
    qDiv.classList.add('question');
    qDiv.dataset.q = qLetter;

    const label = document.createElement('label');
    label.textContent = text;
    qDiv.appendChild(label);

    const opts = document.createElement('div');
    opts.classList.add('options');

    for (let val=1; val<=4; val++) {
      const optLabel = document.createElement('label');
      const input = document.createElement('input');
      input.type = 'radio';
      input.name = `${index}_${qLetter}`;
      input.value = val;
      optLabel.appendChild(input);
      optLabel.append(val);
      opts.appendChild(optLabel);
    }
    qDiv.appendChild(opts);
    div.appendChild(qDiv);
  });

  const sum = document.createElement('div');
  sum.classList.add('sum');
  sum.innerHTML = `Сума: <span id="sum${index}">0</span> / 10`;
  div.appendChild(sum);

  const btn = document.createElement('button');
  btn.textContent = index === data.length - 1 ? "Завершити" : "Далі";
  btn.disabled = true;
  btn.addEventListener('click', () => nextBlock(index));
  div.appendChild(btn);

  container.appendChild(div);
});

// === Логіка для кожного блоку ===
const minPerQ = 1;
const maxTotal = 10;

function initBlock(index) {
  const block = document.getElementById(`block${index}`);
  const radios = block.querySelectorAll('input[type="radio"]');
  const questions = ['A','B','C','D'];

  // за замовчуванням кожне питання має 1 бал
  questions.forEach(q=>{
    block.querySelector(`input[name="${index}_${q}"][value="1"]`).checked = true;
  });
  updateAvailability(index);

  radios.forEach(r=>r.addEventListener('change',()=>updateAvailability(index)));
}

function getCurrentValues(index) {
  const block = document.getElementById(`block${index}`);
  const questions = ['A','B','C','D'];
  return questions.map(q=>{
    const checked = block.querySelector(`input[name="${index}_${q}"]:checked`);
    return checked ? parseInt(checked.value) : 0;
  });
}

function updateAvailability(index) {
  const block = document.getElementById(`block${index}`);
  const sumDisplay = document.getElementById(`sum${index}`);
  const questions = ['A','B','C','D'];
  const values = getCurrentValues(index);
  const total = values.reduce((a,b)=>a+b,0);
  sumDisplay.textContent = total;
  const remaining = maxTotal - total;

  questions.forEach((q,i)=>{
    const currentVal = values[i];
    const inputs = block.querySelectorAll(`input[name="${index}_${q}"]`);
    inputs.forEach(inp=>{
      inp.disabled = false;
      const val = parseInt(inp.value);
      if (val - currentVal > remaining) inp.disabled = true;
      if (val <= currentVal) inp.disabled = false;
    });
  });

  const btn = block.querySelector('button');
  const allSet = values.every(v=>v>=1) && total == 10;
  btn.disabled = !allSet;
}

function nextBlock(index) {
  const current = document.getElementById(`block${index}`);
  current.classList.add('hidden');

  if (index + 1 < data.length) {
    const next = document.getElementById(`block${index+1}`);
    next.classList.remove('hidden');
    initBlock(index+1);
  } else {
    showResults();
  }
}

function showResults() {
  container.classList.add('hidden');
  const results = document.getElementById('results');
  results.classList.remove('hidden');

  const totals = [0,0,0,0]; // A,B,C,D
  const allRadios = document.querySelectorAll('input[type="radio"]:checked');
  allRadios.forEach(r=>{
    const parts = r.name.split('_')[1];
    const idx = ['A','B','C','D'].indexOf(parts);
    totals[idx] += parseInt(r.value);
  });

  document.getElementById('scoreA').textContent = totals[0];
  document.getElementById('scoreB').textContent = totals[1];
  document.getElementById('scoreC').textContent = totals[2];
  document.getElementById('scoreD').textContent = totals[3];

  const maxVal = Math.max(...totals);
  const labels = ['A (P – Виконавець)','B (A – Адміністратор)','C (E – Підприємець)','D (I – Інтегратор)'];
  document.getElementById('dominant').textContent = `Домінантна роль: ${labels[totals.indexOf(maxVal)]}`;
}

// ініціалізація першого блоку
initBlock(0);
</script>
</body>
</html>
